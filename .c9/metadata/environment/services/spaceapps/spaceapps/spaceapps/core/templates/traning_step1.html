{"filter":false,"title":"traning_step1.html","tooltip":"/services/spaceapps/spaceapps/spaceapps/core/templates/traning_step1.html","undoManager":{"mark":50,"position":50,"stack":[[{"start":{"row":43,"column":0},"end":{"row":212,"column":0},"action":"remove","lines":["var imageCapture;","var images = [];","","function onGetUserMediaButtonClick() {","  navigator.mediaDevices.getUserMedia({video: true})","  .then(mediaStream => {","    document.querySelector('video').srcObject = mediaStream;","","    const track = mediaStream.getVideoTracks()[0];","    imageCapture = new ImageCapture(track);","  })","  .catch(error => ChromeSamples.log(error));","}","","function onGrabFrameButtonClick() {","  ","  // imageCapture.takePhoto()","  // .then(blob => createImageBitmap(blob))","  // .then(imageBitmap => {","  //   const canvas = document.querySelector('#takePhotoCanvas');","  //   drawCanvas(canvas, imageBitmap);","  // })","  // .catch(error => console.log(error));","  ","  ","  ","  imageCapture.grabFrame()","  .then(imageBitmap => {","    images.push(drawCanvas(imageBitmap));","  }).catch(error => console.error(error));","  // .catch(error => ChromeSamples.log(error));","}","","","/* Utils */","","function drawCanvas(img) {","  canvas = document.createElement('canvas');","  console.log(img);","  canvas.width = 350;","  canvas.height = 350;","  ","","  let ratio  = Math.min(canvas.width / img.width, canvas.height / img.height);","  let x = (canvas.width - img.width * ratio) / 2;","  let y = (canvas.height - img.height * ratio) / 2;","  canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);","  canvas.getContext('2d').drawImage(img, 0, 0, img.width, img.height,","      x, y, img.width * ratio, img.height * ratio);","  return canvas.toDataURL();","}","","","","function handleError(error) {","  console.error('navigator.getUserMedia error: ', error);","}","const constraints = {video: true};","","","","(function() {","  const video = document.querySelector('#basic video');","  const captureVideoButton = document.querySelector('#basic .capture-button');","  const x = null","  const fd = new FormData()","  ","  function handleSuccess(stream) {","    ","    localMediaStream = stream;","    video.srcObject = stream;","    ","  }",""," function stopEventStreming() {","    ","    // var list_tmp = []","    ","    // $(images).each(function(i, obj){","      ","      ","    //   console.log(obj);","    //   console.log(typeof(obj));","","    //   // console.log(obj.image.toString('base64'));","","      ","    //   // list_tmp.push(obj.image.toString('base64'));","      ","    // });","    ","    // images = list_tmp","    ","    console.log(images)","  ","    video.pause();","    // localMediaStream.stop();","    console.log('STOP COMPLETE');","    ","     $.ajax({","            url: \"{% url  'core:receive_blob' %}\",","            data: {","                images:images,","                label:1,","            },","            dataType: 'json',","            method:\"POST\",","            success: function(data) {","                if (data) {","                    console.log(data.message);","                    $('#cash_in').text('R$ ' + data.cash)","                }","            }","        });","  }","  ","  $(\".capture-button\").on('click', function() {","    ","    console.log('CAPTURE BUTTON')","    ","    var time = 5;","    var x = setInterval(function(){","      onGrabFrameButtonClick()   ","      if (time < 0) {","        clearInterval(x);","        stopEventStreming();","      }","      time = time-1;","    }, 500);","    ","  });","","","})();","","(function() {","  onGetUserMediaButtonClick()","  const captureVideoButton = document.querySelector('#screenshot .capture-button');","  const screenshotButton = document.querySelector('#screenshot-button');","  const img = document.querySelector('#screenshot img');","  const video = document.querySelector('#screenshot video');","","  const canvas = document.createElement('canvas');","","  $(\".capture-button\").on('click', function() {","    navigator.mediaDevices.getUserMedia(constraints).","      then(handleSuccess).catch(handleError);","  });","","  ","","  function handleSuccess(stream) {","    console.log(\"stream:\",stream)","    screenshotButton.disabled = false;","    video.srcObject = stream;","  }","})();","","(function() {","","  $(\".capture-button\").on('click', function() {","    navigator.mediaDevices.getUserMedia(constraints).","      then(handleSuccess).catch(handleError);","  });","","  function handleSuccess(stream) {","    video.srcObject = stream;","  }","})();",""],"id":2887,"ignore":true}],[{"start":{"row":40,"column":0},"end":{"row":45,"column":9},"action":"remove","lines":["","<script>","","","","</script>"],"id":2888,"ignore":true}],[{"start":{"row":39,"column":9},"end":{"row":40,"column":0},"action":"remove","lines":["",""],"id":2889,"ignore":true}],[{"start":{"row":3,"column":0},"end":{"row":5,"column":0},"action":"insert","lines":["","",""],"id":2890,"ignore":true}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":1},"action":"insert","lines":["<"],"id":2891,"ignore":true}],[{"start":{"row":4,"column":1},"end":{"row":4,"column":4},"action":"insert","lines":["inp"],"id":2892,"ignore":true}],[{"start":{"row":4,"column":1},"end":{"row":4,"column":4},"action":"remove","lines":["inp"],"id":2893,"ignore":true},{"start":{"row":4,"column":1},"end":{"row":4,"column":28},"action":"insert","lines":["input type=\"text\" name=\"\"/>"]}],[{"start":{"row":4,"column":13},"end":{"row":4,"column":17},"action":"remove","lines":["text"],"id":2894,"ignore":true},{"start":{"row":4,"column":13},"end":{"row":4,"column":15},"action":"insert","lines":["hi"]}],[{"start":{"row":4,"column":13},"end":{"row":4,"column":15},"action":"remove","lines":["hi"],"id":2895,"ignore":true},{"start":{"row":4,"column":13},"end":{"row":4,"column":19},"action":"insert","lines":["hidden"]}],[{"start":{"row":4,"column":20},"end":{"row":4,"column":28},"action":"remove","lines":[" name=\"\""],"id":2896,"ignore":true}],[{"start":{"row":4,"column":20},"end":{"row":4,"column":21},"action":"insert","lines":[" "],"id":2897,"ignore":true}],[{"start":{"row":4,"column":21},"end":{"row":4,"column":33},"action":"insert","lines":["receive_blob"],"id":2898,"ignore":true}],[{"start":{"row":4,"column":21},"end":{"row":4,"column":33},"action":"remove","lines":["receive_blob"],"id":2899,"ignore":true}],[{"start":{"row":4,"column":21},"end":{"row":4,"column":24},"action":"insert","lines":["id "],"id":2900,"ignore":true}],[{"start":{"row":4,"column":23},"end":{"row":4,"column":24},"action":"remove","lines":[" "],"id":2901,"ignore":true}],[{"start":{"row":4,"column":23},"end":{"row":4,"column":24},"action":"insert","lines":["="],"id":2902,"ignore":true}],[{"start":{"row":4,"column":24},"end":{"row":4,"column":26},"action":"insert","lines":["\"\""],"id":2903,"ignore":true}],[{"start":{"row":4,"column":25},"end":{"row":4,"column":37},"action":"insert","lines":["receive_blob"],"id":2904,"ignore":true}],[{"start":{"row":4,"column":37},"end":{"row":4,"column":38},"action":"insert","lines":["_"],"id":2905,"ignore":true}],[{"start":{"row":4,"column":38},"end":{"row":4,"column":40},"action":"insert","lines":["ur"],"id":2906,"ignore":true}],[{"start":{"row":4,"column":40},"end":{"row":4,"column":41},"action":"insert","lines":["l"],"id":2907,"ignore":true}],[{"start":{"row":4,"column":42},"end":{"row":4,"column":46},"action":"insert","lines":[" val"],"id":2908,"ignore":true}],[{"start":{"row":4,"column":46},"end":{"row":4,"column":48},"action":"insert","lines":["ue"],"id":2909,"ignore":true}],[{"start":{"row":4,"column":48},"end":{"row":4,"column":49},"action":"insert","lines":["="],"id":2910,"ignore":true}],[{"start":{"row":4,"column":49},"end":{"row":4,"column":51},"action":"insert","lines":["\"\""],"id":2911,"ignore":true}],[{"start":{"row":4,"column":50},"end":{"row":4,"column":51},"action":"insert","lines":["{"],"id":2912,"ignore":true}],[{"start":{"row":4,"column":51},"end":{"row":4,"column":55},"action":"insert","lines":["% %}"],"id":2913,"ignore":true}],[{"start":{"row":4,"column":52},"end":{"row":4,"column":56},"action":"insert","lines":[" url"],"id":2914,"ignore":true}],[{"start":{"row":4,"column":56},"end":{"row":4,"column":59},"action":"insert","lines":[" ''"],"id":2915,"ignore":true}],[{"start":{"row":4,"column":58},"end":{"row":4,"column":59},"action":"insert","lines":["c"],"id":2916,"ignore":true}],[{"start":{"row":4,"column":59},"end":{"row":4,"column":62},"action":"insert","lines":["ore"],"id":2917,"ignore":true}],[{"start":{"row":4,"column":62},"end":{"row":4,"column":75},"action":"insert","lines":[":receive_blob"],"id":2918,"ignore":true}],[{"start":{"row":30,"column":0},"end":{"row":34,"column":30},"action":"remove","lines":["\t<!-- Team Section end-->","","","\t<!-- Promotion section -->","\t<!-- Promotion section end-->"],"id":2919,"ignore":true}],[{"start":{"row":7,"column":22},"end":{"row":8,"column":1},"action":"insert","lines":["","\t"],"id":2920,"ignore":true}],[{"start":{"row":8,"column":1},"end":{"row":8,"column":3},"action":"insert","lines":["<>"],"id":2921,"ignore":true}],[{"start":{"row":8,"column":2},"end":{"row":8,"column":8},"action":"insert","lines":["input "],"id":2922,"ignore":true}],[{"start":{"row":8,"column":8},"end":{"row":8,"column":10},"action":"insert","lines":["ty"],"id":2923,"ignore":true}],[{"start":{"row":8,"column":10},"end":{"row":8,"column":15},"action":"insert","lines":["pe=\"\""],"id":2924,"ignore":true}],[{"start":{"row":8,"column":14},"end":{"row":8,"column":20},"action":"insert","lines":["hidden"],"id":2925,"ignore":true}],[{"start":{"row":8,"column":21},"end":{"row":8,"column":27},"action":"insert","lines":[" value"],"id":2926,"ignore":true}],[{"start":{"row":8,"column":27},"end":{"row":8,"column":28},"action":"insert","lines":["="],"id":2927,"ignore":true}],[{"start":{"row":8,"column":28},"end":{"row":8,"column":30},"action":"insert","lines":["\"\""],"id":2928,"ignore":true}],[{"start":{"row":8,"column":29},"end":{"row":8,"column":30},"action":"insert","lines":["1"],"id":2929,"ignore":true}],[{"start":{"row":8,"column":31},"end":{"row":8,"column":33},"action":"insert","lines":[" /"],"id":2930,"ignore":true}],[{"start":{"row":8,"column":7},"end":{"row":8,"column":10},"action":"insert","lines":[" id"],"id":2931,"ignore":true}],[{"start":{"row":8,"column":10},"end":{"row":8,"column":11},"action":"insert","lines":["0"],"id":2932,"ignore":true}],[{"start":{"row":8,"column":11},"end":{"row":8,"column":12},"action":"insert","lines":["#"],"id":2933,"ignore":true}],[{"start":{"row":8,"column":11},"end":{"row":8,"column":12},"action":"remove","lines":["#"],"id":2934,"ignore":true}],[{"start":{"row":8,"column":11},"end":{"row":8,"column":12},"action":"insert","lines":["="],"id":2935,"ignore":true}],[{"start":{"row":8,"column":10},"end":{"row":8,"column":11},"action":"remove","lines":["0"],"id":2936},{"start":{"row":8,"column":11},"end":{"row":8,"column":18},"action":"insert","lines":["\"label\""]}],[{"start":{"row":8,"column":11},"end":{"row":8,"column":18},"action":"insert","lines":["\"label\""],"id":2937,"ignore":true}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":29,"column":8},"end":{"row":29,"column":8},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1571546353100,"hash":"2ed514d3d48c5bbfe639bc4481b58813767ded60"}